# 🌐 代理配置指南

## 当前网络问题

程序显示：
```
connect ETIMEDOUT 69.63.176.59:443
connect ETIMEDOUT 199.59.150.49:443
```

这说明无法连接到 Polymarket API 服务器。

## 代理配置方法

### 方法一：环境变量方式（推荐）

#### Windows PowerShell

```powershell
# 设置 HTTP 代理（替换为您的实际代理地址和端口）
$env:HTTP_PROXY="http://127.0.0.1:7890"
$env:HTTPS_PROXY="http://127.0.0.1:7890"
$env:http_proxy="http://127.0.0.1:7890"
$env:https_proxy="http://127.0.0.1:7890"

# 如果需要认证
# $env:HTTP_PROXY="http://username:password@127.0.0.1:7890"

# 验证设置
echo "HTTP_PROXY: $env:HTTP_PROXY"
echo "HTTPS_PROXY: $env:HTTPS_PROXY"

# 然后运行程序
npm start
```

#### Windows CMD

```cmd
set HTTP_PROXY=http://127.0.0.1:7890
set HTTPS_PROXY=http://127.0.0.1:7890
set http_proxy=http://127.0.0.1:7890
set https_proxy=http://127.0.0.1:7890

npm start
```

#### Linux/Mac

```bash
export HTTP_PROXY=http://127.0.0.1:7890
export HTTPS_PROXY=http://127.0.0.1:7890
export http_proxy=http://127.0.0.1:7890
export https_proxy=http://127.0.0.1:7890

npm start
```

### 方法二：npm 配置代理

```bash
# 配置 npm 代理
npm config set proxy http://127.0.0.1:7890
npm config set https-proxy http://127.0.0.1:7890

# 查看配置
npm config get proxy
npm config get https-proxy

# 运行程序
npm start

# 如果需要取消代理
npm config delete proxy
npm config delete https-proxy
```

### 方法三：在代码中配置代理

我可以在代码中添加代理支持，但需要先知道您的代理地址。

### 方法四：使用 .env 文件

创建 `.env` 文件：

```bash
# .env
HTTP_PROXY=http://127.0.0.1:7890
HTTPS_PROXY=http://127.0.0.1:7890
POLYMARKET_PRIVATE_KEY=0x您的私钥
```

然后在代码中读取（需要安装 `dotenv` 包）。

## 常见代理软件默认端口

| 代理软件 | 默认端口 | 说明 |
|---------|---------|------|
| Clash | 7890 | 通常 http 和 socks5 都是 7890 |
| V2Ray | 10808 | 通常用于 socks5 |
| Shadowsocks | 1080 | 通常用于 socks5 |
| 系统代理 | 8080 | 某些系统代理使用此端口 |

## 查找您的代理端口

### Clash

1. 打开 Clash 客户端
2. 查看 "端口" 或 "Port" 设置
3. 通常 HTTP 端口是 7890，SOCKS5 端口也是 7890

### V2Ray

1. 查看 V2Ray 配置
2. 通常在 `config.json` 中的 `inbounds` 部分
3. 查看 HTTP 或 SOCKS5 端口

### 系统代理

如果您使用系统代理，可以：

**Windows:**
```powershell
# 查看系统代理设置
netsh winhttp show proxy
```

**或在设置中查看：**
- 设置 > 网络和 Internet > 代理

## 测试代理连接

### 测试代理是否工作

```powershell
# 设置代理
$env:HTTP_PROXY="http://127.0.0.1:7890"
$env:HTTPS_PROXY="http://127.0.0.1:7890"

# 测试连接
curl -x http://127.0.0.1:7890 https://polymarket.com
# 或
curl --proxy http://127.0.0.1:7890 https://polymarket.com
```

如果返回 HTML 内容，说明代理工作正常。

### 测试 Node.js 是否使用代理

```powershell
# 设置代理
$env:HTTP_PROXY="http://127.0.0.1:7890"
$env:HTTPS_PROXY="http://127.0.0.1:7890"

# 测试
node -e "const https = require('https'); https.get('https://polymarket.com', (res) => { console.log('状态码:', res.statusCode); });"
```

## 永久配置代理（可选）

### Windows - 系统环境变量

1. 右键"此电脑" > "属性"
2. "高级系统设置" > "环境变量"
3. "新建用户变量"：
   - 变量名：`HTTP_PROXY`
   - 变量值：`http://127.0.0.1:7890`
4. 同样添加 `HTTPS_PROXY`

### Linux/Mac - .bashrc 或 .zshrc

```bash
echo 'export HTTP_PROXY=http://127.0.0.1:7890' >> ~/.bashrc
echo 'export HTTPS_PROXY=http://127.0.0.1:7890' >> ~/.bashrc
source ~/.bashrc
```

## 如果使用 SOCKS5 代理

SOCKS5 代理需要使用 `socks://` 协议：

```powershell
# SOCKS5 代理（Clash 通常同时支持 HTTP 和 SOCKS5）
$env:HTTP_PROXY="socks5://127.0.0.1:7890"
$env:HTTPS_PROXY="socks5://127.0.0.1:7890"

# 或者如果使用专门的 SOCKS5 端口
$env:HTTP_PROXY="socks5://127.0.0.1:7891"
```

**注意**：Node.js 默认不支持 SOCKS5，需要安装额外的包。

## 需要在代码中添加 SOCKS5 支持

如果必须使用 SOCKS5，需要安装：

```bash
npm install socks-proxy-agent https-proxy-agent
```

然后在代码中配置。

## 快速配置脚本

创建一个启动脚本 `start-with-proxy.ps1`：

```powershell
# start-with-proxy.ps1

# 配置代理（修改为您的实际代理）
$PROXY_HOST = "127.0.0.1"
$PROXY_PORT = "7890"
$PROXY_URL = "http://$PROXY_HOST`:$PROXY_PORT"

# 设置环境变量
$env:HTTP_PROXY = $PROXY_URL
$env:HTTPS_PROXY = $PROXY_URL
$env:http_proxy = $PROXY_URL
$env:https_proxy = $PROXY_URL

Write-Host "代理已配置: $PROXY_URL" -ForegroundColor Green

# 测试连接
Write-Host "`n测试代理连接..." -ForegroundColor Yellow
try {
    $response = Invoke-WebRequest -Uri "https://polymarket.com" -Proxy $PROXY_URL -TimeoutSec 5 -UseBasicParsing
    Write-Host "✅ 代理连接成功 (状态码: $($response.StatusCode))" -ForegroundColor Green
} catch {
    Write-Host "❌ 代理连接失败: $_" -ForegroundColor Red
    Write-Host "💡 请检查代理地址和端口是否正确" -ForegroundColor Yellow
    exit 1
}

# 运行程序
Write-Host "`n启动程序...`n" -ForegroundColor Cyan
npm start
```

## 下一步

1. **告诉我您的代理地址和端口**，我可以帮您配置
2. **或者**，如果您的代理是常见的配置（如 Clash 7890），我可以直接创建启动脚本
3. **测试代理连接**，确保可以访问 Polymarket

---

**请告诉我您的代理软件和端口，我可以帮您精确配置！**
