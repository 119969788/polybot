# 使用代理运行程序

## 方法一：使用启动脚本（推荐）

### Windows PowerShell

```powershell
.\start-proxy.ps1
```

### 或者使用 npm 命令

```bash
npm run start:proxy
```

## 方法二：手动设置代理

在 PowerShell 中运行：

```powershell
# 设置代理
$env:HTTP_PROXY="http://127.0.0.1:7890"
$env:HTTPS_PROXY="http://127.0.0.1:7890"
$env:http_proxy="http://127.0.0.1:7890"
$env:https_proxy="http://127.0.0.1:7890"

# 运行程序
npm start
```

## 方法三：一行命令

```powershell
$env:HTTP_PROXY="http://127.0.0.1:7890"; $env:HTTPS_PROXY="http://127.0.0.1:7890"; npm start
```

## 当前代理配置

- **代理软件**: Clash
- **代理端口**: 7890 (HTTP)
- **代理地址**: http://127.0.0.1:7890

## 如果代理端口不同

如果您的代理端口不是 7890，修改 `start-proxy.ps1` 中的：

```powershell
$PROXY_PORT = "7890"  # 改为您的实际端口
```

## 验证代理是否工作

运行程序后，如果看到：
- ✅ "poly-sdk 初始化成功（交易模式）" - 说明代理工作正常
- ❌ "connect ETIMEDOUT" - 说明代理可能有问题

## 常见问题

### 问题：脚本无法运行

**解决方案**：
1. 使用完整路径：
   ```powershell
   powershell -ExecutionPolicy Bypass -File .\start-proxy.ps1
   ```

2. 或者使用 npm 命令：
   ```bash
   npm run start:proxy
   ```

### 问题：代理连接失败

**解决方案**：
1. 确保代理软件（Clash）正在运行
2. 检查代理端口是否正确（默认 7890）
3. 查看代理软件的设置，确认 HTTP 代理端口

### 问题：环境变量未生效

**解决方案**：
确保在同一个 PowerShell 会话中设置环境变量并运行程序。

---

**现在可以直接运行：`.\start-proxy.ps1` 或 `npm run start:proxy`**
